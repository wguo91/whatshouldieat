/*! tellmewheretoeat 2017-02-12 */
"use strict";var express=require("express"),app=express(),path=require("path"),bodyParser=require("body-parser"),morgan=require("morgan"),handlebars=require("express-handlebars"),session=require("express-session"),config=require("./config"),routes=require("./routes"),flash=require("connect-flash"),expressValidator=require("express-validator");app.set("views",path.join(__dirname,"views")),app.engine("handlebars",handlebars({defaultLayout:"layout"})),app.set("view engine","handlebars"),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use(morgan("dev")),app.use(express.static(path.join(__dirname,"public"))),app.use(session({secret:config.secret,saveUninitialized:!0,resave:!0})),app.use(flash()),app.use(function(a,b,c){b.locals.success_msg=a.flash("success_msg"),b.locals.error_msg=a.flash("error_msg"),b.locals.errors=a.flash("errors"),c()}),app.use(expressValidator({errorFormatter:function(a,b,c){for(var d=a.split("."),e=d.shift(),f=e;d.length;)f+="["+d.shift()+"]";return{param:f,msg:b,value:c}}})),app.use("/",routes),app.use(function(a,b){b.status(404),b.render("404",{title:"404 Page Not Found"})}),app.use(function(a,b,c,d){console.log(a),c.status(500),c.render("500",{title:"Internal Server Error"})}),app.listen(config.port);